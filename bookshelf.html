<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>我的书架</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        
		<!-- favicon
		============================================ -->		
        <link rel="shortcut icon" type="image/x-icon" href="assets/images/favicon.ico">
		
		<!-- Google Fonts
		============================================ -->		
        <link href='https://fonts.googleapis.com/css?family=Lato:400,400italic,900,700,700italic,300' rel='stylesheet' type='text/css'>
	   
		<!-- Bootstrap CSS
		============================================ -->		
        <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
        
        <!-- nivo slider CSS
		============================================ -->
		<link rel="stylesheet" href="http://www.jq22.com/demo/jQuery-moban20160527/lib/nivo-slider/css/nivo-slider.css" type="text/css" />
		<link rel="stylesheet" href="http://www.jq22.com/demo/jQuery-moban20160527/lib/nivo-slider/css/preview.css" type="text/css" media="screen" />
        
		<!-- Fontawsome CSS
		============================================ -->
        <link rel="stylesheet" href="http://www.jq22.com/demo/jQuery-moban20160527/css/font-awesome.min.css">
        
		<!-- owl.carousel CSS
		============================================ -->
        <link rel="stylesheet" href="http://www.jq22.com/demo/jQuery-moban20160527/css/owl.carousel.css">
        
		<!-- jquery-ui CSS
		============================================ -->
        <link rel="stylesheet" href="http://www.jq22.com/demo/jQuery-moban20160527/css/jquery-ui.css">
        
		<!-- meanmenu CSS
		============================================ -->
        <link rel="stylesheet" href="http://www.jq22.com/demo/jQuery-moban20160527/css/meanmenu.min.css">
        
		<!-- animate CSS
		============================================ -->
        <link rel="stylesheet" href="http://www.jq22.com/demo/jQuery-moban20160527/css/animate.css">
        
		<!-- style CSS
		============================================ -->
        <link rel="stylesheet" href="/assets/css/style1.css">
        
		<!-- responsive CSS
		============================================ -->
        <link rel="stylesheet" href="/assets/css/responsive1.css">
        
		<!-- modernizr JS
		============================================ -->		
        <script src="/assets/js/modernizr-2.8.3.min.js"></script>
    </head>
    <body>
        <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
        <!--Shop Main Area Start-->
        <div class="shop-main-area">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <!-- Sub Menu 
                        <div class="shop-item-filter">
                            <div class="shop-tab clearfix">
                                <ul class="nav nav-tabs navbar-left" role="tablist">
                                    <li role="presentation" class="active"><a href="shop-grid.html#grid" class="grid-view" aria-controls="grid" role="tab" data-toggle="tab">Grid</a></li>
                                    <li role="presentation"><a href="shop-grid.html#list" class="list-view" aria-controls="list" role="tab" data-toggle="tab">List</a></li>
                                </ul>
                                <div class="filter-by">
                                    <h4>Short by </h4>
                                    <form action="shop-grid.html#">
                                        <div class="select-filter">
                                            <select>
                                              <option value="color">Position</option>
                                              <option value="name">Name</option>
                                              <option value="brand">Brand</option>
                                            </select> 
                                        </div>
                                    </form>								
                                </div>
                                <p class="page floatright">Per Page</p>
                                <div class="filter-by floatright">
                                    <h4>Show </h4>
                                    <form action="shop-grid.html#">
                                        <div class="select-filter">
                                            <select>
                                              <option value="10">12</option>
                                              <option value="20">16</option>
                                              <option value="30">20</option>
                                            </select> 
                                        </div>
                                    </form>	
                                </div>
                            </div>
                        </div>
                        <div class="clearfix"></div> 
                        -->
                        <div class="tab-content">
                            <div role="tabpanel" class="tab-pane active" id="grid">
                                <div class="row" id="book_shelf">
                                </div>
                            </div>   
                        </div>   
                    </div>
                </div>
            </div>
        </div>
        <!--End of Shop Main Area-->
        
		<!-- jquery
		============================================ -->		
        <script src="/assets/js/jquery-1.10.1.min.js"></script>
        
		<!-- bootstrap JS
		============================================ -->		
        <script src="/assets/bootstrap/js/bootstrap.min.js"></script>
        
        <!-- nivo slider js
		============================================ -->       
		<script src="/assets/js/jquery.nivo.slider.js" type="text/javascript"></script>
		<script src="/assets/js/home.js" type="text/javascript"></script>
		
		<!-- wow JS
		============================================ -->		
        <script src="/assets/js/wow.min.js"></script>
        	
		<!-- meanmenu JS
		============================================ -->		
        <script src="/assets/js/jquery.meanmenu.js"></script>
        
		<!-- owl.carousel JS
		============================================ -->		
        <script src="/assets/js/owl.carousel.min.js"></script>
        
		<!-- price-slider JS
		============================================ -->		
        <script src="/assets/js/jquery-price-slider.js"></script>	
        
		<!-- scrollUp JS
		============================================ -->		
        <script src="/assets/js/jquery.scrollUp.min.js"></script>
        
        <!--Countdown js-->
        <script src="/assets/js/jquery.countdown.min.js"></script>
        
		<!-- Sticky Menu JS
		============================================ -->		
        <script src="/assets/js/jquery.sticky.js"></script>
        
		<!-- Elevatezoom JS
		============================================ -->		
        <script src="/assets/js/jquery.elevateZoom-3.0.8.min.js"></script>
        
		<!-- plugins JS
		============================================ -->		
        <script src="/assets/js/plugins.js"></script>
        
		<!-- main JS
		============================================ -->		
        <script src="/assets/js/main.js"></script>
        <!-- UnderScore JS -->
        <script src="/assets/js/jquery-1.10.1.min.js" type="text/javascript" ></script>
        <script src="/assets/js/underscore.js" type="text/javascript" ></script> 

        <!-- Template -->
        <script type="text/template" id="book_template">
            <div class="col-md-3 col-sm-3">
                <div class="single-product-item">
                    <div class="sale-product-label <%=label%>"><span><%=status%></span></div>
                    <div class="book-name"><%=bookName%></div>
                    <div class="author"><%=author%>·著</div>
                    <div class="single-product clearfix">
                        <a href="compose.html#<%=id%>">
                            <span class="product-image">
                                <img src="/assets/images/cover/<%=coverPic%>" alt="">
                            </span>
                        </a>
                        <div class="button-actions clearfix">   
                            <button class="button add-to-cart" type="button">
                                <span>采集</span>
                            </button>
                            <ul class="add-to-links">
                                <li class="quickview">
                                    <a class="btn-quickview modal-view" href="#" data-toggle="modal" data-target="#productModal">
                                        编辑
                                    </a>
                                </li>
                                <li>
                                    <a class="link-wishlist" href="pay.html">
                                        支付
                                    </a>
                                </li>                                                                                       
                                <li>
                                    <a class="link-compare" href="#">
                                        派送
                                    </a>
                                </li>                                           
                            </ul>
                        </div>
                    </div>
                    <h2 class="single-product-name"><a href="shop-grid.html#"><%=bookName%></a></h2>
                    <div class="price-box">
                        <p class="special-price">
                            <span class="price"><%=createTime%></span>
                        </p>                                            
                    </div>
                </div>
            </div>
        </script> 
        <script type="text/javascript">
        jQuery(document).ready(function() {
            if(window.sessionStorage.getItem("UserCode")){
                var userId = window.sessionStorage.getItem("UserCode");
            }else{
                window.location="http://120.77.245.158/login";
            }
             var book = _.template($('#book_template').html());
             $.ajax({
                type:       "GET",
                url:        'http://120.77.245.158:8088/api/Book/GetBookDataByUserId?UserId=' + userId,
                dataType:   "json",
                success: function(data) {
                    var shelf = "";
                    for(var i = 0; i< data.length; i++) {
                        var bookState = "";
                        var bookLabel = "";
                        switch(data[i].c_State) {
                            case 1:                 bookState = "可编辑";   bookLabel = "edit-label";  break;
                            case 2:                 bookState = "已下单";   bookLabel = "order-label";  break;
                            case 3:                 bookState = "印刷中";   bookLabel = "print-label";  break;
                            case 4:                 bookState = "派送中";   bookLabel = "send-label";  break;
                            case 5:                 bookState = "完  成";   bookLabel = "over-label";  break;
                            default:                bookState = "";         bookLabel = "none-label";
                        }
                        shelf += book({
                            label:             bookLabel,
                            status:            bookState,
                            coverPic:          data[i].c_CoverImage==null?"add.jpg":data[i].c_CoverImage,
                            bookName:          data[i].c_BookName,
                            author:            data[i].c_Author,
                            id:                data[i].c_ID,
                            createTime:        data[i].c_CreateDate.split('T')[0]
                        })
                    }
                    $("#book_shelf").html(shelf);
                    $(document).attr("title",data[0].c_Author+"的书架");
                },
                error: function(data) {
                    console.log("通知应飞改bug");
                }
            });
        });
        </script>
    </body>
</html>